# ü©∫ ECG Analysis (Drupal 11 module)

**Repository:** [https://github.com/SergD61/ecg_analysis](https://github.com/SergD61/ecg_analysis)  
**License:** MIT

---

## Overview

`ecg_analysis` ‚Äî –º–æ–¥—É–ª—å –¥–ª—è Drupal 11, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏, —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –≠–ö–ì-–∑–∞–ø–∏—Å–µ–π.  
–ú–æ–¥—É–ª—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ—Ç–æ–∫–æ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`int16 LE`, —á–∞—Å—Ç–æ—Ç–∞ ‚Äî 125 –ì—Ü) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–∏–≥–Ω–∞–ª–∞.

---

## ‚úÖ Current Features

- **File upload:** `/admin/ecg/upload-raw`
  - –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
  - –ê–Ω—Ç–∏–¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ MD5 + —Ä–∞–∑–º–µ—Ä
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ `public://ecg_raw/`

- **Report view:** `/admin/ecg/report/{fid}`
  - –ü–æ—Ç–æ–∫–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç—å
  - –†–∞—Å—á—ë—Ç `total_samples`, `duration` (–≤ —á:–º–∏–Ω)
  - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∏ —Ç–µ–∫—É—â–µ–π –º–∏–Ω—É—Ç—ã
  - –ü–æ–º–∏–Ω—É—Ç–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (6 –ø–∞–Ω–µ–ª–µ–π √ó 10 —Å–µ–∫—É–Ω–¥)
  - –ö–Ω–æ–ø–∫–∏ ¬´–ü—Ä–µ–¥. / –°–ª–µ–¥.¬ª –∏ –ø–æ–ª–µ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –º–∏–Ω—É—Ç–µ
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (AJAX)

- **Visualization:**
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π canvas-–≥—Ä–∞—Ñ–∏–∫ (–¥–æ 1250 px –ø–æ —à–∏—Ä–∏–Ω–µ)
  - –ï–¥–∏–Ω—ã–π –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –º–∞—Å—à—Ç–∞–± –¥–ª—è –≤—Å–µ—Ö –ø–∞–Ω–µ–ª–µ–π
  - –ó–∞—â–∏—Ç–∞ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤: **–∂—ë—Å—Ç–∫–∏–π –ø–æ—Ç–æ–ª–æ–∫ –∞–º–ø–ª–∏—Ç—É–¥—ã ¬±1500**
  - Retina-friendly —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –∏ –ø–ª–∞–≤–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## ‚öôÔ∏è Key Files

| Path | Purpose |
|------|----------|
| `src/Form/EcgRawUploadForm.php` | –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ |
| `src/Controller/EcgReportController.php` | –ü–æ—Ç–æ–∫–æ–≤—ã–π –ø–∞—Ä—Å–∏–Ω–≥, AJAX –º–∏–Ω—É—Ç—ã |
| `templates/ecg-report.html.twig` | –®–∞–±–ª–æ–Ω –æ—Ç—á—ë—Ç–∞ |
| `js/ecg_viewer.js` | –í–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä –≠–ö–ì |
| `css/ecg_style.css` | –°—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ |
| `ecg_analysis.libraries.yml` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ JS –∏ CSS |

---

## üöß Next Steps (new branch)

Planned for the next branch ‚Üí `feature/r-peak-detection`:

1. **R-peak detection** and RR-interval analysis  
2. **Noise segmentation** and visual marking  
3. **Robust scaling** (percentiles 1‚Äì99%)  
4. **Export to CSV / JSON**  
5. **UI actions:** Download, Recalculate, Labels  
6. **header auto-detection** (`HEADER_BYTES`)

---

### Author

Project developed by **SergD61**


